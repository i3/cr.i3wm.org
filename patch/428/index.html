
<!DOCTYPE html>
<html>
  <head>
    <title>i3 Patch: This patch fixes ticket #1168 to extend the window IPC event mechanism to send IPC events for window focus and title changes. The newly added window events use the same format as the already established &#34;new&#34; event.</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" media="screen" href="http://i3wm.org/css/style.css">
    <link rel="stylesheet" type="text/css" media="screen" href="/public/stylesheets/main.css">
    <link rel="shortcut icon" type="image/png" href="http://i3wm.org/favicon.png">
    <script src="/public/js/jquery-1.9.0.min.js" type="text/javascript" charset="utf-8"></script>
	<link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet' type='text/css'>
    
    
      <script src="/public/js/patch.js" type="text/javascript" charset="utf-8"></script>
    
  </head>
  <body>


<div id="main">
	<a href="/"><h1 id="title">i3 - improved tiling WM</h1></a>
				<ul id="nav">
						<li><a style="border-bottom: 2px solid #fff" href="/">Reviews</a></li>
						<li><a href="http://bugs.i3wm.org/">Bugs</a></li>
				</ul>
<br style="clear: both">

<div id="content">

<h1>This patch fixes ticket #1168 to extend the window IPC event mechanism to send IPC events for window focus and title changes. The newly added window events use the same format as the already established &#34;new&#34; event.</h1>
<div style="float: right">
<p>
Patch status: needinfo
</p>
<p>
Patch by Marco Hunsicker
</p>
</div>

<p>
<strong>Long description</strong>:<br>
<pre>Specifically this patch:

* Moves the ipc_send_window_event() function from src/manage.c into
  src/ipc.c and adds an argument for the change property of the event
* Updates src/manage.c to use the new function signature. To ensure
  that the &#34;new&#34; event does not send the same event data as the
  &#34;focus&#34; event, setting focus now happens after the &#34;new&#34; event
  has been sent
* Adds IPC focus event notification to src/x.c. To workaround a problem
  during window close when accessing the window name, a function has been
  added to query whether a window is actually attached to its parent. To
  avoid obsolete focus notification, a new field has been added to keep
  track of the focus without any interference by the click handling
* Adds IPC title event notification to src/handlers.c. To avoid
  obsolete title notification, a function has been added to determine
  whether a window title has actually changed
* Updates the IPC documentation to include the new events
* Updates testcases/t/205-ipc-windows.t to include the &#34;focus&#34; event
  in order to ensure the correct event sequence
* Adds two new unit tests, b/testcases/t/219-ipc-window-focus.t and
  b/testcases/t/220-ipc-window-title.t to ensure proper &#34;focus&#34; and
 &#34;title&#34; events
</pre>
</p>


<p>
To apply this patch, use:<br>
<code>curl http://cr.i3wm.org/patch/428/raw.patch | git am</code>
</p>




<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/docs/ipc</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L48">48</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="48">@@ -1,7 &#43;1,7 @@</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L49">49</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="49"> IPC interface (interprocess communication)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L50">50</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="50"> ==========================================</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L51">51</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="51"> Michael Stapelberg &lt;michael@i3wm.org&gt;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L52">52</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="52">-October 2012</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L53">53</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="53">&#43;February 2014</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L54">54</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="54"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L55">55</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="55"> This document describes how to interface with i3 from a separate process. This</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L56">56</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="56"> is useful for example to remote-control i3 (to write test cases for example) or</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L57">57</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="57">@@ -632,7 &#43;632,8 @@ mode (2)::</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L58">58</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="58"> 	Sent whenever i3 changes its binding mode.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L59">59</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="59"> window (3)::</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L60">60</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="60"> 	Sent when a client&#39;s window is successfully reparented (that is when i3</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L61">61</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="61">-	has finished fitting it into a container).</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L62">62</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="62">&#43;	has finished fitting it into a container), when a window received input</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L63">63</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="63">&#43;	focus or when a window title has been updated.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L64">64</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="64"> barconfig_update (4)::</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L65">65</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="65">     Sent when the hidden_state or mode field in the barconfig of any bar</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L66">66</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="66">     instance was updated.</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L67">67</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="67">@@ -712,14 &#43;713,14 @@ mode is simply named default.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L68">68</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="68"> === window event</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L69">69</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="69"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L70">70</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="70"> This event consists of a single serialized map containing a property</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L71">71</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="71">-&#43;change (string)&#43; which currently can indicate only that a new window</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L72">72</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="72">-has been successfully reparented (the value will be &#34;new&#34;).</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L73">73</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="73">&#43;&#43;change (string)&#43; which indicates the type of the change (&#34;focus&#34;, &#34;new&#34;,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L74">74</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="74">&#43;&#34;title&#34;).</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L75">75</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="75"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L76">76</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="76"> Additionally a &#43;container (object)&#43; field will be present, which consists</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L77">77</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="77">-of the window&#39;s parent container. Be aware that the container will hold</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L78">78</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="78">-the initial name of the newly reparented window (e.g. if you run urxvt</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L79">79</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="79">-with a shell that changes the title, you will still at this point get the</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L80">80</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="80">-window title as &#34;urxvt&#34;).</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L81">81</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="81">&#43;of the window&#39;s parent container. Be aware that for the &#34;new&#34; event, the</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L82">82</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="82">&#43;container will hold the initial name of the newly reparented window (e.g.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L83">83</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="83">&#43;if you run urxvt with a shell that changes the title, you will still at</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L84">84</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="84">&#43;this point get the window title as &#34;urxvt&#34;).</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L85">85</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="85"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L86">86</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="86"> *Example:*</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L87">87</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="87"> ---------------------------</pre>
  </td>
  </tr>


</table>
</div>

<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/include/ipc.h</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L92">92</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="92">@@ -87,3 &#43;87,9 @@ void dump_node(yajl_gen gen, Con *con, bool inplace_restart);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L93">93</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="93">  * respectively.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L94">94</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="94">  */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L95">95</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="95"> void ipc_send_workspace_focus_event(Con *current, Con *old);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L96">96</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="96">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L97">97</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="97">&#43;/**</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L98">98</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="98">&#43; * For the window events we send, along the usual &#34;change&#34; field,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L99">99</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="99">&#43; * also the window container, in &#34;container&#34;.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L100">100</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="100">&#43; */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L101">101</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="101">&#43;void ipc_send_window_event(const char *property, Con *con);</pre>
  </td>
  </tr>


</table>
</div>

<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/src/handlers.c</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L106">106</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="106">@@ -528,6 &#43;528,17 @@ static void handle_destroy_notify_event(xcb_destroy_notify_event_t *event) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L107">107</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="107">     handle_unmap_notify_event(&amp;unmap);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L108">108</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="108"> }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L109">109</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="109"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L110">110</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="110">&#43;static bool window_name_changed(i3Window *window, char *old_name) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L111">111</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="111">&#43;    if ((old_name == NULL) &amp;&amp; (window-&gt;name == NULL))</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L112">112</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="112">&#43;        return false;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L113">113</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="113">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L114">114</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="114">&#43;    /* Either the old or the new one is NULL, but not both. */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L115">115</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="115">&#43;    if ((old_name == NULL) ^ (window-&gt;name == NULL))</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L116">116</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="116">&#43;        return true;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L117">117</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="117">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L118">118</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="118">&#43;    return (strcmp(old_name, i3string_as_utf8(window-&gt;name)) != 0);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L119">119</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="119">&#43;}</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L120">120</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="120">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L121">121</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="121"> /*</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L122">122</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="122">  * Called when a window changes its title</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L123">123</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="123">  *</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L124">124</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="124">@@ -538,10 &#43;549,17 @@ static bool handle_windowname_change(void *data, xcb_connection_t *conn, uint8_t</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L125">125</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="125">     if ((con = con_by_window_id(window)) == NULL || con-&gt;window == NULL)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L126">126</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="126">         return false;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L127">127</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="127"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L128">128</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="128">&#43;    char *old_name = (con-&gt;window-&gt;name != NULL ? sstrdup(i3string_as_utf8(con-&gt;window-&gt;name)) : NULL);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L129">129</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="129">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L130">130</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="130">     window_update_name(con-&gt;window, prop, false);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L131">131</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="131"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L132">132</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="132">     x_push_changes(croot);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L133">133</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="133"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L134">134</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="134">&#43;    if (window_name_changed(con-&gt;window, old_name))</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L135">135</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="135">&#43;        ipc_send_window_event(&#34;title&#34;, con);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L136">136</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="136">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L137">137</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="137">&#43;    FREE(old_name);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L138">138</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="138">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L139">139</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="139">     return true;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L140">140</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="140"> }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L141">141</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="141"> </pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L142">142</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="142">@@ -556,10 &#43;574,17 @@ static bool handle_windowname_change_legacy(void *data, xcb_connection_t *conn,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L143">143</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="143">     if ((con = con_by_window_id(window)) == NULL || con-&gt;window == NULL)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L144">144</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="144">         return false;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L145">145</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="145"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L146">146</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="146">&#43;    char *old_name = (con-&gt;window-&gt;name != NULL ? sstrdup(i3string_as_utf8(con-&gt;window-&gt;name)) : NULL);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L147">147</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="147">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L148">148</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="148">     window_update_name_legacy(con-&gt;window, prop, false);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L149">149</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="149"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L150">150</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="150">     x_push_changes(croot);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L151">151</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="151"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L152">152</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="152">&#43;    if (window_name_changed(con-&gt;window, old_name))</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L153">153</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="153">&#43;        ipc_send_window_event(&#34;title&#34;, con);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L154">154</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="154">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L155">155</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="155">&#43;    FREE(old_name);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L156">156</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="156">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L157">157</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="157">     return true;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L158">158</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="158"> }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L159">159</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="159"> </pre>
  </td>
  </tr>


</table>
</div>

<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/src/ipc.c</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L164">164</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="164">@@ -1056,3 &#43;1056,33 @@ void ipc_send_workspace_focus_event(Con *current, Con *old) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L165">165</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="165">     y(free);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L166">166</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="166">     setlocale(LC_NUMERIC, &#34;&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L167">167</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="167"> }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L168">168</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="168">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L169">169</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="169">&#43;/**</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L170">170</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="170">&#43; * For the window events we send, along the usual &#34;change&#34; field,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L171">171</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="171">&#43; * also the window container, in &#34;container&#34;.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L172">172</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="172">&#43; */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L173">173</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="173">&#43;void ipc_send_window_event(const char *property, Con *con) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L174">174</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="174">&#43;    DLOG(&#34;Issue IPC window %s event for X11 window 0x%08x\n&#34;, property, con-&gt;window-&gt;id);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L175">175</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="175">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L176">176</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="176">&#43;    setlocale(LC_NUMERIC, &#34;C&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L177">177</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="177">&#43;    yajl_gen gen = ygenalloc();</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L178">178</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="178">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L179">179</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="179">&#43;    y(map_open);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L180">180</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="180">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L181">181</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="181">&#43;    ystr(&#34;change&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L182">182</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="182">&#43;    ystr(property);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L183">183</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="183">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L184">184</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="184">&#43;    ystr(&#34;container&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L185">185</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="185">&#43;    dump_node(gen, con, false);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L186">186</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="186">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L187">187</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="187">&#43;    y(map_close);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L188">188</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="188">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L189">189</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="189">&#43;    const unsigned char *payload;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L190">190</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="190">&#43;    ylength length;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L191">191</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="191">&#43;    y(get_buf, &amp;payload, &amp;length);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L192">192</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="192">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L193">193</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="193">&#43;    ipc_send_event(&#34;window&#34;, I3_IPC_EVENT_WINDOW, (const char *)payload);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L194">194</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="194">&#43;    y(free);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L195">195</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="195">&#43;    setlocale(LC_NUMERIC, &#34;&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L196">196</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="196">&#43;}</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L197">197</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="197">&#43;</pre>
  </td>
  </tr>


</table>
</div>

<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/src/manage.c</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L202">202</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="202">@@ -76,35 &#43;76,6 @@ void restore_geometry(void) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L203">203</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="203"> }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L204">204</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="204"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L205">205</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="205"> /*</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L206">206</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="206">- * The following function sends a new window event, which consists</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L207">207</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="207">- * of fields &#34;change&#34; and &#34;container&#34;, the latter containing a dump</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L208">208</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="208">- * of the window&#39;s container.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L209">209</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="209">- *</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L210">210</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="210">- */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L211">211</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="211">-static void ipc_send_window_new_event(Con *con) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L212">212</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="212">-    setlocale(LC_NUMERIC, &#34;C&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L213">213</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="213">-    yajl_gen gen = ygenalloc();</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L214">214</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="214">-</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L215">215</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="215">-    y(map_open);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L216">216</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="216">-</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L217">217</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="217">-    ystr(&#34;change&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L218">218</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="218">-    ystr(&#34;new&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L219">219</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="219">-</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L220">220</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="220">-    ystr(&#34;container&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L221">221</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="221">-    dump_node(gen, con, false);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L222">222</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="222">-</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L223">223</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="223">-    y(map_close);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L224">224</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="224">-</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L225">225</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="225">-    const unsigned char *payload;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L226">226</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="226">-    ylength length;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L227">227</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="227">-    y(get_buf, &amp;payload, &amp;length);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L228">228</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="228">-</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L229">229</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="229">-    ipc_send_event(&#34;window&#34;, I3_IPC_EVENT_WINDOW, (const char *)payload);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L230">230</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="230">-    y(free);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L231">231</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="231">-    setlocale(LC_NUMERIC, &#34;&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L232">232</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="232">-}</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L233">233</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="233">-</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L234">234</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="234">-/*</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L235">235</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="235">  * Do some sanity checks and then reparent the window.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L236">236</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="236">  *</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L237">237</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="237">  */</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L238">238</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="238">@@ -360,6 &#43;331,8 @@ void manage_window(xcb_window_t window, xcb_get_window_attributes_cookie_t cooki</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L239">239</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="239"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L240">240</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="240">     FREE(state_reply);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L241">241</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="241"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L242">242</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="242">&#43;    bool set_focus = false;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L243">243</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="243">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L244">244</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="244">     if (fs == NULL) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L245">245</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="245">         DLOG(&#34;Not in fullscreen mode, focusing\n&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L246">246</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="246">         if (!cwindow-&gt;dock) {</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L247">247</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="247">@@ -371,7 &#43;344,7 @@ void manage_window(xcb_window_t window, xcb_get_window_attributes_cookie_t cooki</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L248">248</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="248"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L249">249</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="249">             if (workspace_is_visible(ws) &amp;&amp; current_output == target_output) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L250">250</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="250">                 if (!match || !match-&gt;restart_mode) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L251">251</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="251">-                    con_focus(nc);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L252">252</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="252">&#43;                    set_focus = true;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L253">253</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="253">                 } else DLOG(&#34;not focusing, matched with restart_mode == true\n&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L254">254</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="254">             } else DLOG(&#34;workspace not visible, not focusing\n&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L255">255</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="255">         } else DLOG(&#34;dock, not focusing\n&#34;);</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L256">256</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="256">@@ -421,7 &#43;394,7 @@ void manage_window(xcb_window_t window, xcb_get_window_attributes_cookie_t cooki</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L257">257</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="257">                    transient_win-&gt;transient_for != XCB_NONE) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L258">258</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="258">                 if (transient_win-&gt;transient_for == fs-&gt;window-&gt;id) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L259">259</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="259">                     LOG(&#34;This floating window belongs to the fullscreen window (popup_during_fullscreen == smart)\n&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L260">260</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="260">-                    con_focus(nc);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L261">261</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="261">&#43;                    set_focus = true;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L262">262</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="262">                     break;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L263">263</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="263">                 }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L264">264</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="264">                 Con *next_transient = con_by_window_id(transient_win-&gt;transient_for);</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L265">265</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="265">@@ -500,7 &#43;473,14 @@ void manage_window(xcb_window_t window, xcb_get_window_attributes_cookie_t cooki</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L266">266</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="266">     tree_render();</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L267">267</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="267"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L268">268</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="268">     /* Send an event about window creation */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L269">269</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="269">-    ipc_send_window_new_event(nc);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L270">270</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="270">&#43;    ipc_send_window_event(&#34;new&#34;, nc);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L271">271</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="271">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L272">272</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="272">&#43;    /* Defer setting focus after the &#39;new&#39; event has been sent to ensure the</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L273">273</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="273">&#43;     * proper window event sequence. */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L274">274</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="274">&#43;    if (set_focus) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L275">275</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="275">&#43;        con_focus(nc);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L276">276</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="276">&#43;        tree_render();</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L277">277</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="277">&#43;    }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L278">278</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="278"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L279">279</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="279">     /* Windows might get managed with the urgency hint already set (Pidgin is</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L280">280</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="280">      * known to do that), so check for that and handle the hint accordingly.</pre>
  </td>
  </tr>


</table>
</div>

<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/src/x.c</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L285">285</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="285">@@ -15,6 &#43;15,11 @@</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L286">286</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="286"> /* Stores the X11 window ID of the currently focused window */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L287">287</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="287"> xcb_window_t focused_id = XCB_NONE;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L288">288</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="288"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L289">289</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="289">&#43;/* Because &#39;focused_id&#39; might be reset to force input focus, we separately keep</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L290">290</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="290">&#43; * track of the X11 window ID to be able to always tell whether the focused</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L291">291</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="291">&#43; * window actually changed. */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L292">292</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="292">&#43;static xcb_window_t last_focused = XCB_NONE;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L293">293</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="293">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L294">294</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="294"> /* The bottom-to-top window stack of all windows which are managed by i3.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L295">295</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="295">  * Used for x_get_window_stack(). */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L296">296</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="296"> static xcb_window_t *btt_stack;</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L297">297</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="297">@@ -232,7 &#43;237,7 @@ void x_con_kill(Con *con) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L298">298</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="298">     free(state);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L299">299</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="299"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L300">300</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="300">     /* Invalidate focused_id to correctly focus new windows with the same ID */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L301">301</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="301">-    focused_id = XCB_NONE;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L302">302</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="302">&#43;    focused_id = last_focused = XCB_NONE;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L303">303</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="303"> }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L304">304</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="304"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L305">305</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="305"> /*</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L306">306</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="306">@@ -849,6 &#43;854,22 @@ static void x_push_node_unmaps(Con *con) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L307">307</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="307"> }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L308">308</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="308"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L309">309</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="309"> /*</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L310">310</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="310">&#43; * Returns true if the given container is currently attached to its parent.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L311">311</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="311">&#43; */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L312">312</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="312">&#43;static bool is_con_attached(Con *con) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L313">313</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="313">&#43;    if (con-&gt;parent == NULL)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L314">314</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="314">&#43;        return false;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L315">315</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="315">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L316">316</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="316">&#43;    Con *current;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L317">317</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="317">&#43;    TAILQ_FOREACH(current, &amp;(con-&gt;parent-&gt;nodes_head), nodes) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L318">318</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="318">&#43;        if (current == con)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L319">319</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="319">&#43;            return true;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L320">320</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="320">&#43;    }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L321">321</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="321">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L322">322</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="322">&#43;    return false;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L323">323</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="323">&#43;}</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L324">324</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="324">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L325">325</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="325">&#43;/*</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L326">326</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="326">  * Pushes all changes (state of each node, see x_push_node() and the window</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L327">327</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="327">  * stack) to X11.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L328">328</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="328">  *</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L329">329</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="329">@@ -990,9 &#43;1011,12 @@ void x_push_changes(Con *con) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L330">330</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="330">                 }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L331">331</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="331"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L332">332</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="332">                 ewmh_update_active_window(to_focus);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L333">333</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="333">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L334">334</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="334">&#43;                if (to_focus != XCB_NONE &amp;&amp; to_focus != last_focused &amp;&amp; focused-&gt;window != NULL &amp;&amp; is_con_attached(focused))</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L335">335</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="335">&#43;                   ipc_send_window_event(&#34;focus&#34;, focused);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L336">336</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="336">             }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L337">337</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="337"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L338">338</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="338">-            focused_id = to_focus;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L339">339</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="339">&#43;            focused_id = last_focused = to_focus;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L340">340</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="340">         }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L341">341</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="341">     }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L342">342</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="342"> </pre>
  </td>
  </tr>


</table>
</div>

<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/testcases/t/205-ipc-windows.t</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L347">347</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="347">@@ -30,19 &#43;30,31 @@ $i3-&gt;connect()-&gt;recv;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L348">348</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="348"> # Events</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L349">349</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="349"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L350">350</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="350"> my $new = AnyEvent-&gt;condvar;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L351">351</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="351">&#43;my $focus = AnyEvent-&gt;condvar;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L352">352</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="352"> $i3-&gt;subscribe({</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L353">353</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="353">     window =&gt; sub {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L354">354</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="354">         my ($event) = @_;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L355">355</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="355">-        $new-&gt;send($event-&gt;{change} eq &#39;new&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L356">356</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="356">&#43;        if ($event-&gt;{change} eq &#39;new&#39;) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L357">357</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="357">&#43;            $new-&gt;send($event);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L358">358</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="358">&#43;        } elsif ($event-&gt;{change} eq &#39;focus&#39;) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L359">359</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="359">&#43;            $focus-&gt;send($event);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L360">360</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="360">&#43;        }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L361">361</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="361">     }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L362">362</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="362"> })-&gt;recv;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L363">363</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="363"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L364">364</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="364"> open_window;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L365">365</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="365"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L366">366</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="366"> my $t;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L367">367</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="367">-$t = AnyEvent-&gt;timer(after =&gt; 0.5, cb =&gt; sub { $new-&gt;send(0); });</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L368">368</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="368">&#43;$t = AnyEvent-&gt;timer(</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L369">369</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="369">&#43;    after =&gt; 0.5,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L370">370</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="370">&#43;    cb =&gt; sub {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L371">371</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="371">&#43;        $new-&gt;send(0);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L372">372</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="372">&#43;        $focus-&gt;send(0);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L373">373</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="373">&#43;    }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L374">374</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="374">&#43;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L375">375</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="375"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L376">376</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="376">-ok($new-&gt;recv, &#39;Window &#34;new&#34; event received&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L377">377</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="377">&#43;is($new-&gt;recv-&gt;{container}-&gt;{focused}, 0, &#39;Window &#34;new&#34; event received&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L378">378</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="378">&#43;is($focus-&gt;recv-&gt;{container}-&gt;{focused}, 1, &#39;Window &#34;focus&#34; event received&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L379">379</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="379"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L380">380</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="380"> }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L381">381</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="381"> </pre>
  </td>
  </tr>


</table>
</div>

<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/testcases/t/219-ipc-window-focus.t</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L387">387</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="387">@@ -0,0 &#43;1,94 @@</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L388">388</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="388">&#43;#!perl</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L389">389</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="389">&#43;# vim:ts=4:sw=4:expandtab</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L390">390</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="390">&#43;#</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L391">391</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="391">&#43;# Please read the following documents before working on tests:</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L392">392</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="392">&#43;#  http://build.i3wm.org/docs/testsuite.html</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L393">393</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="393">&#43;#   (or docs/testsuite)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L394">394</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="394">&#43;#</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L395">395</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="395">&#43;#  http://build.i3wm.org/docs/lib-i3test.html</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L396">396</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="396">&#43;#   (alternatively: perldoc ./testcases/lib/i3test.pm)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L397">397</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="397">&#43;#</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L398">398</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="398">&#43;#  http://build.i3wm.org/docs/ipc.html</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L399">399</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="399">&#43;#   (or docs/ipc)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L400">400</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="400">&#43;#</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L401">401</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="401">&#43;#  http://onyxneon.com/books/modern_perl/modern_perl_a4.pdf</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L402">402</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="402">&#43;#   (unless you are already familiar with Perl)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L403">403</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="403">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L404">404</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="404">&#43;use i3test;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L405">405</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="405">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L406">406</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="406">&#43;SKIP: {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L407">407</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="407">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L408">408</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="408">&#43;    skip &#34;AnyEvent::I3 too old (need &gt;= 0.15)&#34;, 1 if $AnyEvent::I3::VERSION &lt; 0.15;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L409">409</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="409">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L410">410</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="410">&#43;my $i3 = i3(get_socket_path());</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L411">411</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="411">&#43;$i3-&gt;connect()-&gt;recv;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L412">412</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="412">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L413">413</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="413">&#43;################################</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L414">414</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="414">&#43;# Window focus event</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L415">415</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="415">&#43;################################</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L416">416</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="416">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L417">417</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="417">&#43;cmd &#39;split h&#39;;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L418">418</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="418">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L419">419</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="419">&#43;my $win0 = open_window;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L420">420</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="420">&#43;my $win1 = open_window;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L421">421</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="421">&#43;my $win2 = open_window;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L422">422</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="422">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L423">423</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="423">&#43;my $focus = AnyEvent-&gt;condvar;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L424">424</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="424">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L425">425</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="425">&#43;$i3-&gt;subscribe({</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L426">426</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="426">&#43;    window =&gt; sub {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L427">427</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="427">&#43;        my ($event) = @_;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L428">428</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="428">&#43;        $focus-&gt;send($event);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L429">429</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="429">&#43;    }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L430">430</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="430">&#43;})-&gt;recv;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L431">431</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="431">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L432">432</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="432">&#43;my $t;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L433">433</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="433">&#43;$t = AnyEvent-&gt;timer(</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L434">434</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="434">&#43;    after =&gt; 0.5,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L435">435</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="435">&#43;    cb =&gt; sub {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L436">436</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="436">&#43;        $focus-&gt;send(0);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L437">437</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="437">&#43;    }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L438">438</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="438">&#43;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L439">439</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="439">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L440">440</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="440">&#43;# ensure the rightmost window contains input focus</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L441">441</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="441">&#43;$i3-&gt;command(&#39;[id=&#34;&#39; . $win2-&gt;id . &#39;&#34;] focus&#39;)-&gt;recv;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L442">442</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="442">&#43;is($x-&gt;input_focus, $win2-&gt;id, &#34;Window 2 focused&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L443">443</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="443">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L444">444</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="444">&#43;cmd &#39;focus left&#39;;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L445">445</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="445">&#43;my $event = $focus-&gt;recv;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L446">446</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="446">&#43;is($event-&gt;{change}, &#39;focus&#39;, &#39;Focus event received&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L447">447</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="447">&#43;is($focus-&gt;recv-&gt;{container}-&gt;{name}, &#39;Window 1&#39;, &#39;Window 1 focused&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L448">448</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="448">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L449">449</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="449">&#43;$focus = AnyEvent-&gt;condvar;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L450">450</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="450">&#43;cmd &#39;focus left&#39;;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L451">451</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="451">&#43;$event = $focus-&gt;recv;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L452">452</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="452">&#43;is($event-&gt;{change}, &#39;focus&#39;, &#39;Focus event received&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L453">453</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="453">&#43;is($event-&gt;{container}-&gt;{name}, &#39;Window 0&#39;, &#39;Window 0 focused&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L454">454</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="454">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L455">455</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="455">&#43;$focus = AnyEvent-&gt;condvar;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L456">456</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="456">&#43;cmd &#39;focus right&#39;;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L457">457</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="457">&#43;$event = $focus-&gt;recv;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L458">458</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="458">&#43;is($event-&gt;{change}, &#39;focus&#39;, &#39;Focus event received&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L459">459</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="459">&#43;is($event-&gt;{container}-&gt;{name}, &#39;Window 1&#39;, &#39;Window 1 focused&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L460">460</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="460">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L461">461</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="461">&#43;$focus = AnyEvent-&gt;condvar;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L462">462</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="462">&#43;cmd &#39;focus right&#39;;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L463">463</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="463">&#43;$event = $focus-&gt;recv;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L464">464</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="464">&#43;is($event-&gt;{change}, &#39;focus&#39;, &#39;Focus event received&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L465">465</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="465">&#43;is($event-&gt;{container}-&gt;{name}, &#39;Window 2&#39;, &#39;Window 2 focused&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L466">466</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="466">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L467">467</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="467">&#43;$focus = AnyEvent-&gt;condvar;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L468">468</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="468">&#43;cmd &#39;focus right&#39;;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L469">469</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="469">&#43;$event = $focus-&gt;recv;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L470">470</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="470">&#43;is($event-&gt;{change}, &#39;focus&#39;, &#39;Focus event received&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L471">471</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="471">&#43;is($event-&gt;{container}-&gt;{name}, &#39;Window 0&#39;, &#39;Window 0 focused&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L472">472</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="472">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L473">473</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="473">&#43;$focus = AnyEvent-&gt;condvar;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L474">474</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="474">&#43;cmd &#39;focus left&#39;;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L475">475</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="475">&#43;$event = $focus-&gt;recv;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L476">476</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="476">&#43;is($event-&gt;{change}, &#39;focus&#39;, &#39;Focus event received&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L477">477</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="477">&#43;is($event-&gt;{container}-&gt;{name}, &#39;Window 2&#39;, &#39;Window 2 focused&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L478">478</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="478">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L479">479</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="479">&#43;}</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L480">480</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="480">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L481">481</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="481">&#43;done_testing;</pre>
  </td>
  </tr>


</table>
</div>

<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/testcases/t/220-ipc-window-title.t</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L487">487</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="487">@@ -0,0 &#43;1,57 @@</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L488">488</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="488">&#43;#!perl</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L489">489</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="489">&#43;# vim:ts=4:sw=4:expandtab</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L490">490</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="490">&#43;#</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L491">491</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="491">&#43;# Please read the following documents before working on tests:</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L492">492</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="492">&#43;#  http://build.i3wm.org/docs/testsuite.html</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L493">493</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="493">&#43;#   (or docs/testsuite)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L494">494</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="494">&#43;#</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L495">495</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="495">&#43;#  http://build.i3wm.org/docs/lib-i3test.html</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L496">496</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="496">&#43;#   (alternatively: perldoc ./testcases/lib/i3test.pm)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L497">497</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="497">&#43;#</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L498">498</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="498">&#43;#  http://build.i3wm.org/docs/ipc.html</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L499">499</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="499">&#43;#   (or docs/ipc)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L500">500</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="500">&#43;#</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L501">501</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="501">&#43;#  http://onyxneon.com/books/modern_perl/modern_perl_a4.pdf</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L502">502</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="502">&#43;#   (unless you are already familiar with Perl)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L503">503</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="503">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L504">504</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="504">&#43;use i3test;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L505">505</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="505">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L506">506</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="506">&#43;SKIP: {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L507">507</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="507">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L508">508</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="508">&#43;    skip &#34;AnyEvent::I3 too old (need &gt;= 0.15)&#34;, 1 if $AnyEvent::I3::VERSION &lt; 0.15;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L509">509</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="509">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L510">510</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="510">&#43;my $i3 = i3(get_socket_path());</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L511">511</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="511">&#43;$i3-&gt;connect()-&gt;recv;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L512">512</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="512">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L513">513</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="513">&#43;################################</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L514">514</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="514">&#43;# Window title event</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L515">515</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="515">&#43;################################</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L516">516</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="516">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L517">517</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="517">&#43;my $window = open_window(name =&gt; &#39;Window 0&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L518">518</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="518">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L519">519</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="519">&#43;my $title = AnyEvent-&gt;condvar;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L520">520</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="520">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L521">521</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="521">&#43;$i3-&gt;subscribe({</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L522">522</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="522">&#43;    window =&gt; sub {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L523">523</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="523">&#43;        my ($event) = @_;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L524">524</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="524">&#43;        $title-&gt;send($event);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L525">525</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="525">&#43;    }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L526">526</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="526">&#43;})-&gt;recv;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L527">527</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="527">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L528">528</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="528">&#43;$window-&gt;name(&#39;New Window Title&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L529">529</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="529">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L530">530</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="530">&#43;my $t;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L531">531</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="531">&#43;$t = AnyEvent-&gt;timer(</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L532">532</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="532">&#43;    after =&gt; 0.5,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L533">533</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="533">&#43;    cb =&gt; sub {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L534">534</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="534">&#43;        $title-&gt;send(0);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L535">535</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="535">&#43;    }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L536">536</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="536">&#43;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L537">537</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="537">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L538">538</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="538">&#43;my $event = $title-&gt;recv;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L539">539</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="539">&#43;is($event-&gt;{change}, &#39;title&#39;, &#39;Window title change event received&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L540">540</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="540">&#43;is($event-&gt;{container}-&gt;{name}, &#39;New Window Title&#39;, &#39;Window title changed&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L541">541</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="541">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L542">542</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="542">&#43;}</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L543">543</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="543">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L544">544</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="544">&#43;done_testing;</pre>
  </td>
  </tr>


</table>
</div>


</div>

  </body>
</html>

