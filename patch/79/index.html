
<!DOCTYPE html>
<html>
  <head>
    <title>i3 Patch: Add optional bidirectional interface to i3bar. (ver.9)</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" media="screen" href="http://i3wm.org/css/style.css">
    <link rel="stylesheet" type="text/css" media="screen" href="/public/stylesheets/main.css">
    <link rel="shortcut icon" type="image/png" href="http://i3wm.org/favicon.png">
    <script src="/public/js/jquery-1.9.0.min.js" type="text/javascript" charset="utf-8"></script>
	<link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet' type='text/css'>
    
    
      <script src="/public/js/patch.js" type="text/javascript" charset="utf-8"></script>
    
  </head>
  <body>


<div id="main">
	<a href="/"><h1 id="title">i3 - improved tiling WM</h1></a>
				<ul id="nav">
						<li><a style="border-bottom: 2px solid #fff" href="/">Reviews</a></li>
						<li><a href="http://bugs.i3wm.org/">Bugs</a></li>
				</ul>
<br style="clear: both">

<div id="content">

<h1>Add optional bidirectional interface to i3bar. (ver.9)</h1>
<div style="float: right">
<p>
Patch status: superseded
</p>
<p>
Patch by enkore
</p>
</div>

<p>
<strong>Long description</strong>:<br>
<pre>If the child specifies bidirectional:1 in the protocl header,
a JSON array will be streamed to it&#39;s stdin.
It consists of maps with at least one key (command).

Such a map is emitted if the user clicks on a status block. i.e.
{&#34;command&#34;:&#34;block_clicked&#34;,&#34;name&#34;:&#34;some_block_name&#34;,&#34;instance&#34;:&#34;optional_instance&#34;}

The basic output format is like the rest of the i3bar protocol (i.e.
a new line after each element (map in this case))

The second version of this patch mainly introduced a better API for sending
commands.

The third version of this patch introduced the additional button parameter and thus
added support for right clicks. Now root window coordinates are passed instead of
window coordinates.

The fourth version of this patch (re-)added closing of unused pipe fd&#39;s.
Some superfluous whitespace was removed, too.

The fifth version of this patch changed some implementation details and
added handling of all mouse buttons by the child.

The sixth version of this patch changed the bidirectional-key in the
protocol header to a boolean.

The seventh version of this patch fixed a memory leak.

The 8th version of this patch fixed switching workspaces by scrolling

The 9th version is a one-line fix.
</pre>
</p>


<p>
To apply this patch, use:<br>
<code>curl http://cr.i3wm.org/patch/79/raw.patch | git am</code>
</p>




<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/docs/i3bar-protocol</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L49">49</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="49">@@ -51,7 &#43;51,7 @@ consists of a single JSON hash:</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L50">50</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="50"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L51">51</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="51"> *All features example*:</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L52">52</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="52"> ------------------------------</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L53">53</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="53">-{ &#34;version&#34;: 1, &#34;stop_signal&#34;: 10, &#34;cont_signal&#34;: 12 }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L54">54</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="54">&#43;{ &#34;version&#34;: 1, &#34;stop_signal&#34;: 10, &#34;cont_signal&#34;: 12, &#34;bidirectional&#34;: 1 }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L55">55</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="55"> ------------------------------</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L56">56</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="56"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L57">57</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="57"> (Note that before i3 v4.3 the precise format had to be &#43;{&#34;version&#34;:1}&#43;,</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L58">58</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="58">@@ -110,6 &#43;110,9 @@ cont_signal::</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L59">59</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="59"> 	Specify to i3bar the signal (as an integer)to send to continue your</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L60">60</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="60"> 	processing.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L61">61</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="61"> 	The default value (if none is specified) is SIGCONT.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L62">62</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="62">&#43;bidirectional::</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L63">63</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="63">&#43;	If specified and true i3bar will write a infinite array (same as above)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L64">64</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="64">&#43;	to your stdin.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L65">65</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="65"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L66">66</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="66"> === Blocks in detail</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L67">67</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="67"> </pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L68">68</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="68">@@ -183,3 &#43;186,32 @@ An example of a block which uses all possible entries follows:</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L69">69</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="69">  &#34;instance&#34;: &#34;eth0&#34;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L70">70</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="70"> }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L71">71</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="71"> ------------------------------------------</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L72">72</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="72">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L73">73</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="73">&#43;=== Bidirectional communication</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L74">74</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="74">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L75">75</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="75">&#43;If enabled i3bar will send you notifications about certain events, currently</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L76">76</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="76">&#43;only one such notification is implemented: block_clicked.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L77">77</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="77">&#43;It is sent if the user clicks on a block and looks like this:</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L78">78</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="78">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L79">79</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="79">&#43;command::</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L80">80</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="80">&#43;	Always block_clicked at the moment, but more are maybe added later.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L81">81</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="81">&#43;name::</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L82">82</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="82">&#43;	Name of the block, if set</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L83">83</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="83">&#43;instance::</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L84">84</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="84">&#43;	Instance of the block, if set</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L85">85</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="85">&#43;x, y::</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L86">86</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="86">&#43;	X11 root window coordinates where the click occured</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L87">87</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="87">&#43;button:</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L88">88</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="88">&#43;	X11 button ID (for example 1 to 3 for left/middle/right mouse button)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L89">89</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="89">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L90">90</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="90">&#43;*Example*:</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L91">91</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="91">&#43;------------------------------------------</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L92">92</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="92">&#43;{</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L93">93</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="93">&#43; &#34;command&#34;: &#34;block_clicked&#34;,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L94">94</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="94">&#43; &#34;name&#34;: &#34;ethernet&#34;,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L95">95</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="95">&#43; &#34;instance&#34;: &#34;eth0&#34;,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L96">96</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="96">&#43; &#34;button&#34;: 1,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L97">97</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="97">&#43; &#34;x&#34;: 1320,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L98">98</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="98">&#43; &#34;y&#34;: 1400</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L99">99</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="99">&#43;}</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L100">100</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="100">&#43;------------------------------------------</pre>
  </td>
  </tr>


</table>
</div>

<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/i3bar/include/child.h</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L105">105</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="105">@@ -33,6 &#43;33,12 @@ typedef struct {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L106">106</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="106">      * The signal requested by the client to inform it of theun hidden state of i3bar</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L107">107</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="107">      */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L108">108</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="108">     int cont_signal;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L109">109</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="109">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L110">110</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="110">&#43;    /**</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L111">111</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="111">&#43;     * Enable bi-directional communication, i.e. on-click events</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L112">112</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="112">&#43;     */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L113">113</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="113">&#43;    bool bidirectional;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L114">114</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="114">&#43;    bool bidirectional_init;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L115">115</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="115"> } i3bar_child;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L116">116</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="116"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L117">117</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="117"> /*</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L118">118</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="118">@@ -68,4 &#43;74,10 @@ void stop_child(void);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L119">119</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="119">  */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L120">120</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="120"> void cont_child(void);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L121">121</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="121"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L122">122</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="122">&#43;/*</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L123">123</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="123">&#43; * ends the block_clicked command to the child</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L124">124</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="124">&#43; *</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L125">125</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="125">&#43; */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L126">126</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="126">&#43;void send_block_clicked(int button, const char *name, const char *instance, int x, int y);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L127">127</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="127">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L128">128</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="128"> #endif</pre>
  </td>
  </tr>


</table>
</div>

<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/i3bar/include/common.h</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L133">133</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="133">@@ -50,6 &#43;50,10 @@ struct status_block {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L134">134</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="134">     uint32_t x_offset;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L135">135</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="135">     uint32_t x_append;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L136">136</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="136"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L137">137</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="137">&#43;    /* Optional */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L138">138</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="138">&#43;    char *name;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L139">139</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="139">&#43;    char *instance;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L140">140</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="140">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L141">141</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="141">     TAILQ_ENTRY(status_block) blocks;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L142">142</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="142"> };</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L143">143</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="143"> </pre>
  </td>
  </tr>


</table>
</div>

<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/i3bar/src/child.c</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L148">148</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="148">@@ -21,6 &#43;21,7 @@</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L149">149</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="149"> #include &lt;yajl/yajl_common.h&gt;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L150">150</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="150"> #include &lt;yajl/yajl_parse.h&gt;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L151">151</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="151"> #include &lt;yajl/yajl_version.h&gt;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L152">152</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="152">&#43;#include &lt;yajl/yajl_gen.h&gt;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L153">153</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="153"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L154">154</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="154"> #include &#34;common.h&#34;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L155">155</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="155"> </pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L156">156</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="156">@@ -35,6 &#43;36,9 @@ ev_child *child_sig;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L157">157</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="157"> yajl_callbacks callbacks;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L158">158</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="158"> yajl_handle parser;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L159">159</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="159"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L160">160</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="160">&#43;/* JSON generator for stdout */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L161">161</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="161">&#43;yajl_gen gen;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L162">162</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="162">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L163">163</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="163"> typedef struct parser_ctx {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L164">164</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="164">     /* True if one of the parsed blocks was urgent */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L165">165</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="165">     bool has_urgent;</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L166">166</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="166">@@ -85,6 &#43;89,10 @@ static int stdin_start_array(void *context) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L167">167</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="167">         first = TAILQ_FIRST(&amp;statusline_head);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L168">168</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="168">         I3STRING_FREE(first-&gt;full_text);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L169">169</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="169">         FREE(first-&gt;color);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L170">170</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="170">&#43;        if(first-&gt;name != NULL)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L171">171</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="171">&#43;            FREE(first-&gt;name);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L172">172</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="172">&#43;        if(first-&gt;instance != NULL)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L173">173</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="173">&#43;            FREE(first-&gt;instance);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L174">174</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="174">         TAILQ_REMOVE(&amp;statusline_head, first, blocks);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L175">175</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="175">         free(first);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L176">176</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="176">     }</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L177">177</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="177">@@ -141,6 &#43;149,18 @@ static int stdin_string(void *context, const unsigned char *val, unsigned int le</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L178">178</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="178">             ctx-&gt;block.align = ALIGN_CENTER;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L179">179</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="179">         }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L180">180</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="180">     }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L181">181</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="181">&#43;    if (strcasecmp(ctx-&gt;last_map_key, &#34;name&#34;) == 0) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L182">182</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="182">&#43;        char *copy = (char*)malloc(len&#43;1);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L183">183</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="183">&#43;        strncpy(copy, (const char *)val, len);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L184">184</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="184">&#43;        copy[len] = 0;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L185">185</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="185">&#43;        ctx-&gt;block.name = copy;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L186">186</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="186">&#43;    }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L187">187</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="187">&#43;    if (strcasecmp(ctx-&gt;last_map_key, &#34;instance&#34;) == 0) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L188">188</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="188">&#43;        char *copy = (char*)malloc(len&#43;1);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L189">189</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="189">&#43;        strncpy(copy, (const char *)val, len);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L190">190</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="190">&#43;        copy[len] = 0;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L191">191</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="191">&#43;        ctx-&gt;block.instance = copy;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L192">192</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="192">&#43;    }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L193">193</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="193">     return 1;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L194">194</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="194"> }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L195">195</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="195"> </pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L196">196</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="196">@@ -322,6 &#43;342,18 @@ void child_sig_cb(struct ev_loop *loop, ev_child *watcher, int revents) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L197">197</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="197">     cleanup();</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L198">198</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="198"> }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L199">199</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="199"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L200">200</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="200">&#43;void child_write_output(void) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L201">201</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="201">&#43;    if(child.bidirectional) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L202">202</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="202">&#43;        const unsigned char *output;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L203">203</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="203">&#43;        size_t size;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L204">204</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="204">&#43;        yajl_gen_get_buf(gen, &amp;output, &amp;size);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L205">205</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="205">&#43;        fwrite(output, 1, size, stdout);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L206">206</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="206">&#43;        fwrite(&#34;\n&#34;, 1, 1, stdout);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L207">207</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="207">&#43;        fflush(stdout);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L208">208</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="208">&#43;        yajl_gen_clear(gen);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L209">209</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="209">&#43;    }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L210">210</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="210">&#43;}</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L211">211</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="211">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L212">212</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="212"> /*</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L213">213</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="213">  * Start a child-process with the specified command and reroute stdin.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L214">214</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="214">  * We actually start a $SHELL to execute the command so we don&#39;t have to care</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L215">215</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="215">@@ -347,10 &#43;379,16 @@ void start_child(char *command) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L216">216</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="216">     parser = yajl_alloc(&amp;callbacks, NULL, &amp;parser_context);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L217">217</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="217"> #endif</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L218">218</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="218"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L219">219</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="219">&#43;    gen = yajl_gen_alloc(NULL);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L220">220</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="220">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L221">221</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="221">     if (command != NULL) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L222">222</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="222">-        int fd[2];</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L223">223</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="223">-        if (pipe(fd) == -1)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L224">224</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="224">-            err(EXIT_FAILURE, &#34;pipe(fd)&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L225">225</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="225">&#43;        int pipe_in[2]; /* pipe we read from */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L226">226</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="226">&#43;        int pipe_out[2]; /* pipe we write to */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L227">227</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="227">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L228">228</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="228">&#43;        if (pipe(pipe_in) == -1)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L229">229</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="229">&#43;            err(EXIT_FAILURE, &#34;pipe(pipe_in)&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L230">230</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="230">&#43;        if (pipe(pipe_out) == -1)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L231">231</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="231">&#43;            err(EXIT_FAILURE, &#34;pipe(pipe_out)&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L232">232</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="232"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L233">233</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="233">         child.pid = fork();</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L234">234</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="234">         switch (child.pid) {</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L235">235</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="235">@@ -358,10 &#43;396,13 @@ void start_child(char *command) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L236">236</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="236">                 ELOG(&#34;Couldn&#39;t fork(): %s\n&#34;, strerror(errno));</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L237">237</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="237">                 exit(EXIT_FAILURE);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L238">238</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="238">             case 0:</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L239">239</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="239">-                /* Child-process. Reroute stdout and start shell */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L240">240</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="240">-                close(fd[0]);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L241">241</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="241">&#43;                /* Child-process. Reroute streams and start shell */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L242">242</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="242"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L243">243</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="243">-                dup2(fd[1], STDOUT_FILENO);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L244">244</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="244">&#43;                close(pipe_in[0]);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L245">245</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="245">&#43;                close(pipe_out[1]);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L246">246</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="246">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L247">247</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="247">&#43;                dup2(pipe_in[1], STDOUT_FILENO);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L248">248</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="248">&#43;                dup2(pipe_out[0], STDIN_FILENO);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L249">249</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="249"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L250">250</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="250">                 static const char *shell = NULL;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L251">251</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="251"> </pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L252">252</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="252">@@ -371,10 &#43;412,13 @@ void start_child(char *command) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L253">253</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="253">                 execl(shell, shell, &#34;-c&#34;, command, (char*) NULL);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L254">254</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="254">                 return;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L255">255</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="255">             default:</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L256">256</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="256">-                /* Parent-process. Rerout stdin */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L257">257</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="257">-                close(fd[1]);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L258">258</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="258">&#43;                /* Parent-process. Reroute streams */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L259">259</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="259">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L260">260</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="260">&#43;                close(pipe_in[1]);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L261">261</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="261">&#43;                close(pipe_out[0]);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L262">262</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="262"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L263">263</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="263">-                dup2(fd[0], STDIN_FILENO);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L264">264</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="264">&#43;                dup2(pipe_in[0], STDIN_FILENO);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L265">265</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="265">&#43;                dup2(pipe_out[1], STDOUT_FILENO);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L266">266</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="266"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L267">267</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="267">                 break;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L268">268</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="268">         }</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L269">269</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="269">@@ -396,6 &#43;440,69 @@ void start_child(char *command) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L270">270</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="270"> }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L271">271</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="271"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L272">272</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="272"> /*</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L273">273</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="273">&#43; * Internal helper functions for bidirectional comms</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L274">274</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="274">&#43; *</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L275">275</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="275">&#43; */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L276">276</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="276">&#43;void child_bidi_initialize(void) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L277">277</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="277">&#43;    if(!child.bidirectional_init) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L278">278</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="278">&#43;        yajl_gen_array_open(gen);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L279">279</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="279">&#43;        child_write_output();</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L280">280</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="280">&#43;        child.bidirectional_init = true;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L281">281</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="281">&#43;    }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L282">282</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="282">&#43;}</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L283">283</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="283">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L284">284</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="284">&#43;void child_bidi_key(const char *key) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L285">285</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="285">&#43;    yajl_gen_string(gen, (const unsigned char *)key, strlen(key));</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L286">286</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="286">&#43;}</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L287">287</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="287">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L288">288</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="288">&#43;void child_bidi_open(const char *command) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L289">289</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="289">&#43;    child_bidi_initialize();</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L290">290</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="290">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L291">291</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="291">&#43;    yajl_gen_map_open(gen);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L292">292</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="292">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L293">293</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="293">&#43;    child_bidi_key(&#34;command&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L294">294</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="294">&#43;    yajl_gen_string(gen, (const unsigned char *)command, strlen(command));</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L295">295</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="295">&#43;}</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L296">296</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="296">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L297">297</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="297">&#43;void child_bidi_close(void) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L298">298</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="298">&#43;    yajl_gen_map_close(gen);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L299">299</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="299">&#43;    child_write_output();</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L300">300</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="300">&#43;}</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L301">301</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="301">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L302">302</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="302">&#43;/*</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L303">303</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="303">&#43; * sends the block_clicked command to the child</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L304">304</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="304">&#43; *</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L305">305</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="305">&#43; */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L306">306</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="306">&#43;void send_block_clicked(int button, const char *name, const char *instance, int x, int y) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L307">307</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="307">&#43;    if(child.bidirectional) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L308">308</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="308">&#43;        child_bidi_open(&#34;block_clicked&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L309">309</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="309">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L310">310</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="310">&#43;        if(name) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L311">311</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="311">&#43;            child_bidi_key(&#34;name&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L312">312</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="312">&#43;            yajl_gen_string(gen, (const unsigned char *)name, strlen(name));</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L313">313</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="313">&#43;        }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L314">314</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="314">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L315">315</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="315">&#43;        if(instance) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L316">316</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="316">&#43;            child_bidi_key(&#34;instance&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L317">317</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="317">&#43;            yajl_gen_string(gen, (const unsigned char *)instance, strlen(instance));</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L318">318</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="318">&#43;        }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L319">319</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="319">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L320">320</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="320">&#43;        child_bidi_key(&#34;button&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L321">321</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="321">&#43;        yajl_gen_integer(gen, button);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L322">322</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="322">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L323">323</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="323">&#43;        child_bidi_key(&#34;x&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L324">324</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="324">&#43;        yajl_gen_integer(gen, x);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L325">325</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="325">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L326">326</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="326">&#43;        child_bidi_key(&#34;y&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L327">327</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="327">&#43;        yajl_gen_integer(gen, y);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L328">328</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="328">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L329">329</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="329">&#43;        yajl_gen_map_close(gen);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L330">330</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="330">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L331">331</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="331">&#43;        child_write_output();</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L332">332</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="332">&#43;    }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L333">333</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="333">&#43;}</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L334">334</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="334">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L335">335</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="335">&#43;/*</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L336">336</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="336">  * kill()s the child-process (if any). Called when exit()ing.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L337">337</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="337">  *</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L338">338</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="338">  */</pre>
  </td>
  </tr>


</table>
</div>

<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/i3bar/src/parse_json_header.c</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L343">343</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="343">@@ -31,6 &#43;31,7 @@ static enum {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L344">344</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="344">     KEY_VERSION,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L345">345</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="345">     KEY_STOP_SIGNAL,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L346">346</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="346">     KEY_CONT_SIGNAL,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L347">347</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="347">&#43;    KEY_BIDIRECTIONAL,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L348">348</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="348">     NO_KEY</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L349">349</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="349"> } current_key;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L350">350</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="350"> </pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L351">351</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="351">@@ -54,6 &#43;55,21 @@ static int header_integer(void *ctx, long val) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L352">352</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="352">         default:</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L353">353</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="353">             break;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L354">354</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="354">     }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L355">355</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="355">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L356">356</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="356">&#43;    return 1;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L357">357</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="357">&#43;}</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L358">358</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="358">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L359">359</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="359">&#43;static int header_boolean(void *ctx, int val) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L360">360</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="360">&#43;    i3bar_child *child = ctx;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L361">361</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="361">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L362">362</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="362">&#43;    switch (current_key) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L363">363</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="363">&#43;        case KEY_BIDIRECTIONAL:</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L364">364</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="364">&#43;            child-&gt;bidirectional = val ? true : false;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L365">365</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="365">&#43;            break;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L366">366</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="366">&#43;        default:</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L367">367</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="367">&#43;            break;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L368">368</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="368">&#43;    }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L369">369</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="369">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L370">370</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="370">     return 1;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L371">371</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="371"> }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L372">372</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="372"> </pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L373">373</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="373">@@ -71,13 &#43;87,15 @@ static int header_map_key(void *ctx, const unsigned char *stringval, unsigned in</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L374">374</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="374">         current_key = KEY_STOP_SIGNAL;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L375">375</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="375">     } else if (CHECK_KEY(&#34;cont_signal&#34;)) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L376">376</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="376">         current_key = KEY_CONT_SIGNAL;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L377">377</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="377">&#43;    } else if (CHECK_KEY(&#34;bidirectional&#34;)) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L378">378</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="378">&#43;        current_key = KEY_BIDIRECTIONAL;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L379">379</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="379">     }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L380">380</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="380">     return 1;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L381">381</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="381"> }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L382">382</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="382"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L383">383</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="383"> static yajl_callbacks version_callbacks = {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L384">384</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="384">     NULL, /* null */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L385">385</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="385">-    NULL, /* boolean */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L386">386</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="386">&#43;    &amp;header_boolean, /* boolean */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L387">387</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="387">     &amp;header_integer,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L388">388</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="388">     NULL, /* double */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L389">389</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="389">     NULL, /* number */</pre>
  </td>
  </tr>


</table>
</div>

<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/i3bar/src/xcb.c</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L394">394</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="394">@@ -306,24 &#43;306,11 @@ void handle_button(xcb_button_press_event_t *event) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L395">395</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="395">     }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L396">396</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="396"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L397">397</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="397">     int32_t x = event-&gt;event_x &gt;= 0 ? event-&gt;event_x : 0;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L398">398</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="398">&#43;    int32_t original_x = x;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L399">399</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="399"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L400">400</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="400">     DLOG(&#34;Got Button %d\n&#34;, event-&gt;detail);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L401">401</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="401"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L402">402</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="402">     switch (event-&gt;detail) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L403">403</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="403">-        case 1:</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L404">404</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="404">-            /* Left Mousbutton. We determine, which button was clicked</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L405">405</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="405">-             * and set cur_ws accordingly */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L406">406</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="406">-            TAILQ_FOREACH(cur_ws, walk-&gt;workspaces, tailq) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L407">407</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="407">-                DLOG(&#34;x = %d\n&#34;, x);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L408">408</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="408">-                if (x &gt;= 0 &amp;&amp; x &lt; cur_ws-&gt;name_width &#43; 10) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L409">409</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="409">-                    break;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L410">410</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="410">-                }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L411">411</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="411">-                x -= cur_ws-&gt;name_width &#43; 11;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L412">412</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="412">-            }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L413">413</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="413">-            if (cur_ws == NULL) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L414">414</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="414">-                return;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L415">415</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="415">-            }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L416">416</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="416">-            break;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L417">417</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="417">         case 4:</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L418">418</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="418">             /* Mouse wheel up. We select the previous ws, if any.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L419">419</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="419">              * If there is no more workspace, dont even send the workspace</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L420">420</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="420">@@ -344,6 &#43;331,50 @@ void handle_button(xcb_button_press_event_t *event) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L421">421</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="421"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L422">422</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="422">             cur_ws = TAILQ_NEXT(cur_ws, tailq);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L423">423</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="423">             break;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L424">424</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="424">&#43;        default:</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L425">425</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="425">&#43;            /* Check if this event regards a workspace button */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L426">426</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="426">&#43;            TAILQ_FOREACH(cur_ws, walk-&gt;workspaces, tailq) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L427">427</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="427">&#43;                DLOG(&#34;x = %d\n&#34;, x);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L428">428</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="428">&#43;                if (x &gt;= 0 &amp;&amp; x &lt; cur_ws-&gt;name_width &#43; 10) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L429">429</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="429">&#43;                    break;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L430">430</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="430">&#43;                }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L431">431</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="431">&#43;                x -= cur_ws-&gt;name_width &#43; 11;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L432">432</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="432">&#43;            }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L433">433</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="433">&#43;            if (cur_ws == NULL) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L434">434</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="434">&#43;                /* No workspace button was pressed.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L435">435</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="435">&#43;                 * Check if a status block has been clicked.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L436">436</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="436">&#43;                 * This of course only has an effect,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L437">437</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="437">&#43;                 * if the child reported bidirectional protocol usage. */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L438">438</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="438">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L439">439</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="439">&#43;                /* First calculate width of tray area */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L440">440</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="440">&#43;                trayclient *trayclient;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L441">441</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="441">&#43;                int tray_width = 0;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L442">442</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="442">&#43;                TAILQ_FOREACH_REVERSE(trayclient, walk-&gt;trayclients, tc_head, tailq) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L443">443</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="443">&#43;                    if (!trayclient-&gt;mapped)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L444">444</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="444">&#43;                        continue;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L445">445</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="445">&#43;                    tray_width &#43;= (font.height &#43; 2);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L446">446</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="446">&#43;                }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L447">447</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="447">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L448">448</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="448">&#43;                int block_x = 0, last_block_x;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L449">449</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="449">&#43;                int offset = (walk-&gt;rect.w - (statusline_width &#43; tray_width)) - 10;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L450">450</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="450">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L451">451</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="451">&#43;                x = original_x - offset &gt; 0 ? original_x - offset : 0;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L452">452</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="452">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L453">453</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="453">&#43;                struct status_block *block;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L454">454</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="454">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L455">455</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="455">&#43;                TAILQ_FOREACH(block, &amp;statusline_head, blocks) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L456">456</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="456">&#43;                    last_block_x = block_x;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L457">457</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="457">&#43;                    block_x &#43;= block-&gt;width &#43; block-&gt;x_offset &#43; block-&gt;x_append;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L458">458</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="458">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L459">459</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="459">&#43;                    if(x &lt;= block_x &amp;&amp; x &gt;= last_block_x) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L460">460</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="460">&#43;                        send_block_clicked(event-&gt;detail, block-&gt;name, block-&gt;instance, event-&gt;root_x, event-&gt;root_y);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L461">461</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="461">&#43;                        return;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L462">462</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="462">&#43;                    }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L463">463</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="463">&#43;                }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L464">464</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="464">&#43;                return;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L465">465</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="465">&#43;            }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L466">466</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="466">&#43;            if (event-&gt;detail != 1)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L467">467</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="467">&#43;                return;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L468">468</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="468">     }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L469">469</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="469"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L470">470</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="470">     /* To properly handle workspace names with double quotes in them, we need</pre>
  </td>
  </tr>


</table>
</div>


</div>

  </body>
</html>

