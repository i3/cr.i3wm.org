
<!DOCTYPE html>
<html>
  <head>
    <title>i3 Patch: Avoid use of uninitialized variable in print_battery_info</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" media="screen" href="http://i3wm.org/css/style.css">
    <link rel="stylesheet" type="text/css" media="screen" href="/public/stylesheets/main.css">
    <link rel="shortcut icon" type="image/png" href="http://i3wm.org/favicon.png">
    <script src="/public/js/jquery-1.9.0.min.js" type="text/javascript" charset="utf-8"></script>
	<link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet' type='text/css'>
    
    
      <script src="/public/js/patch.js" type="text/javascript" charset="utf-8"></script>
    
  </head>
  <body>


<div id="main">
	<a href="/"><h1 id="title">i3 - improved tiling WM</h1></a>
				<ul id="nav">
						<li><a style="border-bottom: 2px solid #fff" href="/">Reviews</a></li>
						<li><a href="http://bugs.i3wm.org/">Bugs</a></li>
				</ul>
<br style="clear: both">

<div id="content">

<h1>Avoid use of uninitialized variable in print_battery_info</h1>
<div style="float: right">
<p>
Patch status: merged
</p>
<p>
Patch by Alexander Monakov
</p>
</div>

<p>
<strong>Long description</strong>:<br>
<pre>The boolean flag &#39;watt_as_unit&#39; may be used without being initialized if the
configured battery path does not contain expected statistics (for example if
it is misconfigured and points to AC adapter info or simply an unrelated file).

Even though it does not cause ill effects, it causes a warning (true positive)
when running i3status under Valgrind.  Initialize the variable to make code
well-defined.
</pre>
</p>


<p>
To apply this patch, use:<br>
<code>curl http://cr.i3wm.org/patch/693/raw.patch | git am</code>
</p>




<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/src/print_battery_info.c</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L20">20</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="20">@@ -44,7 &#43;44,7 @@ void print_battery_info(yajl_gen json_gen, char *buffer, int number, const char</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L21">21</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="21">         char consumptionbuf[256];</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L22">22</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="22">         const char *walk, *last;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L23">23</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="23">         char *outwalk = buffer;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L24">24</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="24">-        bool watt_as_unit;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L25">25</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="25">&#43;        bool watt_as_unit = false;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L26">26</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="26">         bool colorful_output = false;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L27">27</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="27">         int full_design = -1,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L28">28</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="28">             remaining = -1,</pre>
  </td>
  </tr>


</table>
</div>


</div>

  </body>
</html>

