
<!DOCTYPE html>
<html>
  <head>
    <title>i3 Patch: adding window event for urgency</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" media="screen" href="http://i3wm.org/css/style.css">
    <link rel="stylesheet" type="text/css" media="screen" href="/public/stylesheets/main.css">
    <link rel="shortcut icon" type="image/png" href="http://i3wm.org/favicon.png">
    <script src="/public/js/jquery-1.9.0.min.js" type="text/javascript" charset="utf-8"></script>
	<link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet' type='text/css'>
    
    
      <script src="/public/js/patch.js" type="text/javascript" charset="utf-8"></script>
    
  </head>
  <body>


<div id="main">
	<a href="/"><h1 id="title">i3 - improved tiling WM</h1></a>
				<ul id="nav">
						<li><a style="border-bottom: 2px solid #fff" href="/">Reviews</a></li>
						<li><a href="http://bugs.i3wm.org/">Bugs</a></li>
				</ul>
<br style="clear: both">

<div id="content">

<h1>adding window event for urgency</h1>
<div style="float: right">
<p>
Patch status: needinfo
</p>
<p>
Patch by Anders Aagaard
</p>
</div>



<p>
To apply this patch, use:<br>
<code>curl http://cr.i3wm.org/patch/566/raw.patch | git am</code>
</p>




<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/include/con.h</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L21">21</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="21">@@ -338,7 &#43;338,7 @@ void con_update_parents_urgency(Con *con);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L22">22</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="22">  * Set urgency flag to the container, all the parent containers and the workspace.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L23">23</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="23">  *</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L24">24</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="24">  */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L25">25</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="25">-void con_set_urgency(Con *con, bool urgent);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L26">26</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="26">&#43;void con_set_urgency(Con *con, bool urgent, const char *reason);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L27">27</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="27"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L28">28</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="28"> /**</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L29">29</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="29">  * Create a string representing the subtree under con.</pre>
  </td>
  </tr>


</table>
</div>

<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/include/data.h</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L34">34</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="34">@@ -617,3 &#43;617,8 @@ struct Con {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L35">35</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="35">     /* Depth of the container window */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L36">36</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="36">     uint16_t depth;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L37">37</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="37"> };</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L38">38</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="38">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L39">39</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="39">&#43;struct WindowEvent {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L40">40</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="40">&#43;    const char *key;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L41">41</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="41">&#43;    const char *value;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L42">42</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="42">&#43;};</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L43">43</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="43">\ No newline at end of file</pre>
  </td>
  </tr>


</table>
</div>

<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/include/ipc.h</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L48">48</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="48">@@ -90,10 &#43;90,9 @@ void dump_node(yajl_gen gen, Con *con, bool inplace_restart);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L49">49</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="49"> void ipc_send_workspace_focus_event(Con *current, Con *old);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L50">50</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="50"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L51">51</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="51"> /**</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L52">52</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="52">- * For the window events we send, along the usual &#34;change&#34; field,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L53">53</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="53">- * also the window container, in &#34;container&#34;.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L54">54</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="54">&#43; * For the window events we send, along with extra properties.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L55">55</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="55">  */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L56">56</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="56">-void ipc_send_window_event(const char *property, Con *con);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L57">57</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="57">&#43;void ipc_send_window_event(const struct WindowEvent properties[], Con *con);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L58">58</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="58"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L59">59</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="59"> /**</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L60">60</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="60">  * For the barconfig update events, we send the serialized barconfig.</pre>
  </td>
  </tr>


</table>
</div>

<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/src/con.c</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L65">65</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="65">@@ -621,7 &#43;621,8 @@ void con_toggle_fullscreen(Con *con, int fullscreen_mode) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L66">66</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="66">     DLOG(&#34;mode now: %d\n&#34;, con-&gt;fullscreen_mode);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L67">67</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="67"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L68">68</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="68">     /* Send an ipc window &#34;fullscreen_mode&#34; event */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L69">69</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="69">-    ipc_send_window_event(&#34;fullscreen_mode&#34;, con);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L70">70</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="70">&#43;    const struct WindowEvent const windowEvent[] = {{&#34;change&#34;, &#34;fullscreen_mode&#34;}, {NULL, NULL}};</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L71">71</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="71">&#43;    ipc_send_window_event(windowEvent, con);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L72">72</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="72"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L73">73</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="73">     /* update _NET_WM_STATE if this container has a window */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L74">74</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="74">     /* TODO: when a window is assigned to a container which is already</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L75">75</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="75">@@ -1572,7 &#43;1573,7 @@ void con_update_parents_urgency(Con *con) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L76">76</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="76">  * Set urgency flag to the container, all the parent containers and the workspace.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L77">77</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="77">  *</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L78">78</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="78">  */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L79">79</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="79">-void con_set_urgency(Con *con, bool urgent) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L80">80</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="80">&#43;void con_set_urgency(Con *con, bool urgent, const char *reason) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L81">81</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="81">     if (focused == con) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L82">82</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="82">         DLOG(&#34;Ignoring urgency flag for current client\n&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L83">83</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="83">         con-&gt;window-&gt;urgent.tv_sec = 0;</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L84">84</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="84">@@ -1596,6 &#43;1597,8 @@ void con_set_urgency(Con *con, bool urgent) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L85">85</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="85">     }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L86">86</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="86"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L87">87</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="87">     con_update_parents_urgency(con);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L88">88</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="88">&#43;    const struct WindowEvent const windowEvent[] = {{&#34;change&#34;, &#34;urgency&#34;}, {&#34;reason&#34;, reason}, {NULL, NULL}};</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L89">89</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="89">&#43;    ipc_send_window_event(windowEvent, con);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L90">90</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="90"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L91">91</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="91">     if (con-&gt;urgent == urgent)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L92">92</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="92">         LOG(&#34;Urgency flag changed to %d\n&#34;, con-&gt;urgent);</pre>
  </td>
  </tr>


</table>
</div>

<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/src/handlers.c</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L97">97</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="97">@@ -555,8 &#43;555,10 @@ static bool handle_windowname_change(void *data, xcb_connection_t *conn, uint8_t</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L98">98</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="98"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L99">99</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="99">     x_push_changes(croot);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L100">100</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="100"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L101">101</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="101">-    if (window_name_changed(con-&gt;window, old_name))</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L102">102</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="102">-        ipc_send_window_event(&#34;title&#34;, con);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L103">103</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="103">&#43;    if (window_name_changed(con-&gt;window, old_name)) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L104">104</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="104">&#43;        const struct WindowEvent const windowEvent[] = {{&#34;change&#34;, &#34;title&#34;}, {NULL, NULL}};</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L105">105</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="105">&#43;        ipc_send_window_event(windowEvent, con);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L106">106</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="106">&#43;    }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L107">107</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="107"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L108">108</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="108">     FREE(old_name);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L109">109</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="109"> </pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L110">110</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="110">@@ -580,8 &#43;582,10 @@ static bool handle_windowname_change_legacy(void *data, xcb_connection_t *conn,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L111">111</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="111"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L112">112</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="112">     x_push_changes(croot);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L113">113</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="113"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L114">114</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="114">-    if (window_name_changed(con-&gt;window, old_name))</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L115">115</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="115">-        ipc_send_window_event(&#34;title&#34;, con);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L116">116</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="116">&#43;    if (window_name_changed(con-&gt;window, old_name)) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L117">117</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="117">&#43;        const struct WindowEvent const windowEvent[] = {{&#34;change&#34;, &#34;title&#34;}, {NULL, NULL}};</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L118">118</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="118">&#43;        ipc_send_window_event(windowEvent, con);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L119">119</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="119">&#43;    }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L120">120</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="120"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L121">121</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="121">     FREE(old_name);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L122">122</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="122"> </pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L123">123</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="123">@@ -684,12 &#43;688,16 @@ static void handle_client_message(xcb_client_message_event_t *event) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L124">124</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="124">             }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L125">125</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="125">         } else if (event-&gt;data.data32[1] == A__NET_WM_STATE_DEMANDS_ATTENTION) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L126">126</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="126">             /* Check if the urgent flag must be set or not */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L127">127</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="127">-            if (event-&gt;data.data32[0] == _NET_WM_STATE_ADD)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L128">128</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="128">-                con_set_urgency(con, true);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L129">129</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="129">-            else if (event-&gt;data.data32[0] == _NET_WM_STATE_REMOVE)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L130">130</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="130">-                con_set_urgency(con, false);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L131">131</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="131">-            else if (event-&gt;data.data32[0] == _NET_WM_STATE_TOGGLE)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L132">132</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="132">-                con_set_urgency(con, !con-&gt;urgent);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L133">133</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="133">&#43;            if (event-&gt;data.data32[0] == _NET_WM_STATE_ADD) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L134">134</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="134">&#43;                const char *reason = &#34;WM_STATE_ADD&#34;;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L135">135</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="135">&#43;                con_set_urgency(con, true, reason);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L136">136</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="136">&#43;            } else if (event-&gt;data.data32[0] == _NET_WM_STATE_REMOVE) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L137">137</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="137">&#43;                const char *reason = &#34;WM_STATE_REMOVED&#34;;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L138">138</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="138">&#43;                con_set_urgency(con, false, reason);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L139">139</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="139">&#43;            } else if (event-&gt;data.data32[0] == _NET_WM_STATE_TOGGLE) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L140">140</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="140">&#43;                const char *reason = &#34;WM_STATE_TOGGLE&#34;;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L141">141</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="141">&#43;                con_set_urgency(con, !con-&gt;urgent, reason);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L142">142</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="142">&#43;            }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L143">143</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="143">         }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L144">144</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="144"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L145">145</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="145">         tree_render();</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L146">146</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="146">@@ -733,7 &#43;741,8 @@ static void handle_client_message(xcb_client_message_event_t *event) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L147">147</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="147">                 con_focus(con);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L148">148</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="148">             } else {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L149">149</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="149">                 DLOG(&#34;Request to focus con on a hidden workspace. Setting urgent con = %p\n&#34;, con);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L150">150</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="150">-                con_set_urgency(con, true);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L151">151</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="151">&#43;                const char *reason = &#34;FOCUS_BLOCKED&#34;;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L152">152</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="152">&#43;                con_set_urgency(con, true, reason);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L153">153</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="153">             }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L154">154</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="154">         }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L155">155</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="155"> </pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L156">156</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="156">@@ -929,7 &#43;938,8 @@ static bool handle_hints(void *data, xcb_connection_t *conn, uint8_t state, xcb_</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L157">157</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="157">     if (reply == NULL)</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L158">158</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="158">         reply = xcb_get_property_reply(conn, xcb_icccm_get_wm_hints(conn, window), NULL);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L159">159</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="159">     window_update_hints(con-&gt;window, reply, &amp;urgency_hint);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L160">160</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="160">-    con_set_urgency(con, urgency_hint);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L161">161</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="161">&#43;    const char *reason = &#34;WM_HINTS&#34;;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L162">162</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="162">&#43;    con_set_urgency(con, urgency_hint, reason);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L163">163</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="163">     tree_render();</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L164">164</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="164"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L165">165</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="165">     return true;</pre>
  </td>
  </tr>


</table>
</div>

<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/src/ipc.c</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L170">170</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="170">@@ -1080,18 &#43;1080,30 @@ void ipc_send_workspace_focus_event(Con *current, Con *old) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L171">171</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="171">  * For the window events we send, along the usual &#34;change&#34; field,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L172">172</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="172">  * also the window container, in &#34;container&#34;.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L173">173</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="173">  */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L174">174</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="174">-void ipc_send_window_event(const char *property, Con *con) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L175">175</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="175">-    DLOG(&#34;Issue IPC window %s event (con = %p, window = 0x%08x)\n&#34;,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L176">176</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="176">-            property, con, (con-&gt;window ? con-&gt;window-&gt;id : XCB_WINDOW_NONE));</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L177">177</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="177">&#43;/*void ipc_send_window_event(const char *property, Con *con) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L178">178</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="178">&#43;    const struct WindowEvent const crap[] = {{&#34;change&#34;, property}, {NULL, NULL}};</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L179">179</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="179">&#43;    ipc_send_window_eventx(crap, con);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L180">180</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="180">&#43;}*/</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L181">181</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="181">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L182">182</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="182">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L183">183</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="183">&#43;void ipc_send_window_event(const struct WindowEvent properties[], Con *con) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L184">184</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="184">&#43;    DLOG(&#34;Issue IPC window event (con = %p, window = 0x%08x)\n&#34;,</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L185">185</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="185">&#43;            con, (con-&gt;window ? con-&gt;window-&gt;id : XCB_WINDOW_NONE));</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L186">186</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="186"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L187">187</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="187">     setlocale(LC_NUMERIC, &#34;C&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L188">188</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="188">     yajl_gen gen = ygenalloc();</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L189">189</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="189"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L190">190</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="190">     y(map_open);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L191">191</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="191"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L192">192</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="192">-    ystr(&#34;change&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L193">193</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="193">-    ystr(property);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L194">194</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="194">-</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L195">195</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="195">&#43;    int i = 0;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L196">196</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="196">&#43;    while (properties[i].key != NULL) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L197">197</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="197">&#43;        if (properties[i].key != NULL &amp;&amp; properties[i].value != NULL) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L198">198</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="198">&#43;            ystr(properties[i].key);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L199">199</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="199">&#43;            ystr(properties[i].value);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L200">200</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="200">&#43;        }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L201">201</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="201">&#43;        i&#43;&#43;;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L202">202</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="202">&#43;    }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L203">203</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="203">&#43;    </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L204">204</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="204">     ystr(&#34;container&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L205">205</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="205">     dump_node(gen, con, false);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L206">206</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="206"> </pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L207">207</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="207">@@ -1106,6 &#43;1118,7 @@ void ipc_send_window_event(const char *property, Con *con) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L208">208</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="208">     setlocale(LC_NUMERIC, &#34;&#34;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L209">209</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="209"> }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L210">210</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="210"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L211">211</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="211">&#43;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L212">212</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="212"> /**</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L213">213</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="213">  * For the barconfig update events, we send the serialized barconfig.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L214">214</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="214">  */</pre>
  </td>
  </tr>


</table>
</div>

<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/src/manage.c</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L219">219</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="219">@@ -484,7 &#43;484,8 @@ void manage_window(xcb_window_t window, xcb_get_window_attributes_cookie_t cooki</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L220">220</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="220">     render_con(croot, false);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L221">221</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="221"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L222">222</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="222">     /* Send an event about window creation */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L223">223</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="223">-    ipc_send_window_event(&#34;new&#34;, nc);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L224">224</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="224">&#43;    const struct WindowEvent const windowEvent[] = {{&#34;change&#34;, &#34;new&#34;}, {NULL, NULL}};</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L225">225</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="225">&#43;    ipc_send_window_event(windowEvent, nc);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L226">226</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="226"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L227">227</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="227">     /* Defer setting focus after the &#39;new&#39; event has been sent to ensure the</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L228">228</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="228">      * proper window event sequence. */</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L229">229</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="229">@@ -497,7 &#43;498,7 @@ void manage_window(xcb_window_t window, xcb_get_window_attributes_cookie_t cooki</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L230">230</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="230">      * known to do that), so check for that and handle the hint accordingly.</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L231">231</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="231">      * This code needs to be in this part of manage_window() because the window</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L232">232</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="232">      * needs to be on the final workspace first. */</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L233">233</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="233">-    con_set_urgency(nc, urgency_hint);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L234">234</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="234">&#43;    con_set_urgency(nc, urgency_hint, NULL);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L235">235</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="235"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L236">236</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="236"> geom_out:</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L237">237</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="237">     free(geom);</pre>
  </td>
  </tr>


</table>
</div>

<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/src/x.c</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L242">242</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="242">@@ -1015,8 &#43;1015,10 @@ void x_push_changes(Con *con) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L243">243</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="243"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L244">244</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="244">                 ewmh_update_active_window((con_has_managed_window(focused) ? focused-&gt;window-&gt;id : XCB_WINDOW_NONE));</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L245">245</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="245"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L246">246</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="246">-                if (to_focus != last_focused &amp;&amp; is_con_attached(focused))</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L247">247</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="247">-                   ipc_send_window_event(&#34;focus&#34;, focused);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L248">248</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="248">&#43;                if (to_focus != last_focused &amp;&amp; is_con_attached(focused)) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L249">249</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="249">&#43;                   const struct WindowEvent const windowEvent[] = {{&#34;change&#34;, &#34;focus&#34;}, {NULL, NULL}};</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L250">250</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="250">&#43;                   ipc_send_window_event(windowEvent, focused);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L251">251</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="251">&#43;                }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L252">252</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="252">             } else {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L253">253</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="253">                 DLOG(&#34;Updating focus (focused: %p / %s) to X11 window 0x%08x\n&#34;, focused, focused-&gt;name, to_focus);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L254">254</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="254">                 /* We remove XCB_EVENT_MASK_FOCUS_CHANGE from the event mask to get</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L255">255</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="255">@@ -1034,8 &#43;1036,10 @@ void x_push_changes(Con *con) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L256">256</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="256"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L257">257</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="257">                 ewmh_update_active_window((con_has_managed_window(focused) ? focused-&gt;window-&gt;id : XCB_WINDOW_NONE));</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L258">258</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="258"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L259">259</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="259">-                if (to_focus != XCB_NONE &amp;&amp; to_focus != last_focused &amp;&amp; focused-&gt;window != NULL &amp;&amp; is_con_attached(focused))</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L260">260</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="260">-                   ipc_send_window_event(&#34;focus&#34;, focused);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L261">261</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="261">&#43;                if (to_focus != XCB_NONE &amp;&amp; to_focus != last_focused &amp;&amp; focused-&gt;window != NULL &amp;&amp; is_con_attached(focused)) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L262">262</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="262">&#43;                   const struct WindowEvent const windowEvent[] = {{&#34;change&#34;, &#34;focus&#34;}, {NULL, NULL}};</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L263">263</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="263">&#43;                   ipc_send_window_event(windowEvent, focused);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L264">264</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="264">&#43;                }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L265">265</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="265">             }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L266">266</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="266"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L267">267</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="267">             focused_id = last_focused = to_focus;</pre>
  </td>
  </tr>


</table>
</div>

<div style="border: 1px solid #ccc; margin: 1em; width: 880px; overflow-x: auto; background-color: #eaeaea; color: #000;">
<h2 style="margin: 0; padding: .5em; color: #000;">b/testcases/t/205-ipc-windows.t</h2>
<table class="patch" cellpadding="0" cellspacing="0">


  <tr class="linerow">
  <td class="line-number" id="L272">272</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="272">@@ -31,6 &#43;31,7 @@ $i3-&gt;connect()-&gt;recv;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L273">273</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="273"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L274">274</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="274"> my $new = AnyEvent-&gt;condvar;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L275">275</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="275"> my $focus = AnyEvent-&gt;condvar;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L276">276</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="276">&#43;my $urgency = AnyEvent-&gt;condvar;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L277">277</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="277"> $i3-&gt;subscribe({</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L278">278</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="278">     window =&gt; sub {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L279">279</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="279">         my ($event) = @_;</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L280">280</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="280">@@ -38,11 &#43;39,16 @@ $i3-&gt;subscribe({</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L281">281</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="281">             $new-&gt;send($event);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L282">282</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="282">         } elsif ($event-&gt;{change} eq &#39;focus&#39;) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L283">283</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="283">             $focus-&gt;send($event);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L284">284</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="284">&#43;        } elsif ($event-&gt;{change} eq &#39;urgency&#39;) {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L285">285</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="285">&#43;            $urgency-&gt;send($event);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L286">286</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="286">         }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L287">287</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="287">     }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L288">288</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="288"> })-&gt;recv;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L289">289</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="289"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L290">290</td>
  <td width="100%" class="line del">
	  <b class="add-bubble"></b>
	  <pre data-nr="290">-open_window;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L291">291</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="291">&#43;my $first = open_window;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L292">292</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="292">&#43;my $second = open_window;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L293">293</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="293">&#43;$first-&gt;delete_hint(&#39;urgency&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L294">294</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="294">&#43;$first-&gt;add_hint(&#39;urgency&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L295">295</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="295"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L296">296</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="296"> my $t;</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L297">297</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="297"> $t = AnyEvent-&gt;timer(</pre>
  </td>
  </tr>



  <tr class="linerow">
  <td class="line-number" id="L298">298</td>
  <td width="100%" class="line hunk">
	  <b class="add-bubble"></b>
	  <pre data-nr="298">@@ -50,11 &#43;56,13 @@ $t = AnyEvent-&gt;timer(</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L299">299</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="299">     cb =&gt; sub {</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L300">300</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="300">         $new-&gt;send(0);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L301">301</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="301">         $focus-&gt;send(0);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L302">302</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="302">&#43;        $urgency-&gt;send(0);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L303">303</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="303">     }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L304">304</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="304"> );</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L305">305</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="305"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L306">306</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="306"> is($new-&gt;recv-&gt;{container}-&gt;{focused}, 0, &#39;Window &#34;new&#34; event received&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L307">307</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="307"> is($focus-&gt;recv-&gt;{container}-&gt;{focused}, 1, &#39;Window &#34;focus&#34; event received&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L308">308</td>
  <td width="100%" class="line add">
	  <b class="add-bubble"></b>
	  <pre data-nr="308">&#43;is($urgency-&gt;recv-&gt;{reason}, &#34;WM_HINTS&#34;, &#39;Window &#34;urgency&#34; event received&#39;);</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L309">309</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="309"> </pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L310">310</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="310"> }</pre>
  </td>
  </tr>

  <tr class="linerow">
  <td class="line-number" id="L311">311</td>
  <td width="100%" class="line ">
	  <b class="add-bubble"></b>
	  <pre data-nr="311"> </pre>
  </td>
  </tr>


</table>
</div>


</div>

  </body>
</html>

